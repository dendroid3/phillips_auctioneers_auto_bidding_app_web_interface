import{d as M,r as B,c as _,o as m,a as n,u as e,w as l,b as p,e as c,n as S,f as O,g as I,F as j,h as K,i as F,t as k,j as se,k as x,l as de,m as ce,p as me,q as Z,s as ge,v as fe}from"./app-CNrRQ6az.js";import{_ as P,u as ae,c as G,a as pe}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CCYzkzUS.js";import{_ as J,a as Q,b as W,c as U,d as T,e as X,f as C,g as L}from"./dayjs.min-Unooyttk.js";import{_ as ve,a as ee}from"./Label.vue_vue_type_script_setup_true_lang-DKamUR16.js";import{_ as le,a as ie,b as ne,c as _e,d as be,e as ye,f as re}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-D0i9hJZS.js";import{g as he}from"./echo-ClkwrYP1.js";import{_ as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-B326Q0_d.js";import"./useForwardExpose-CQbp9g7N.js";import"./RovingFocusGroup-Basdj6HP.js";const we={class:"flex flex-col space-y-2"},ke={class:"relative"},$e=["disabled","value"],Ve={class:"relative"},Se=["value"],Ae={class:"flex flex-col space-y-2"},Ie={class:"relative"},Te=["value"],Ce={class:"relative"},ze=["value"],Be={class:"flex flex-col space-y-2"},Me={class:"relative"},De=["value"],Ne={class:"relative"},qe=["value"],Ee=M({__name:"AuctionStagesConfigurationTable",props:{stages:{type:Object,required:!0,default:()=>({lazy_stage:{start_time:"",end_time:"",status:""},aggressive_stage:{start_time:"",end_time:"",stage:""},sniping_stage:{start_time:"",end_time:"",stage:""}}),validator:t=>["lazy_stage","aggressive_stage","sniping_stage"].every(y=>t[y])},isAuctionConfigurable:{type:Boolean,required:!0,default:!1}},emits:["update:time","save:time"],setup(t,{emit:y}){const o=y,g=B(!1);function v(d){const a=d.split(":");let s=Number(a[0]),u=Number(a[1]),r=a.length>2?Number(a[2]):0;return r+=1,r>59&&(r=0,u+=1),u>59&&(u=0,s+=1),s>23&&(s=0),[String(s).padStart(2,"0"),String(u).padStart(2,"0"),String(r).padStart(2,"0")].join(":")}const w=(d,a)=>{const s=f=>{const[h,$,A=0]=f.split(":").map(Number);return h*3600+$*60+A};let u=!0;if(a==="lazy_stage.start_time"){const f=s(d);(f<s("10:00:00")||f>s("12:30:00"))&&(u=!1,alert("Lazy stage must end between 11:15 AM and 12:45 PM"),f<s("10:00:00")?(d="11:15:00",u=!0):f>s("12:30:00")&&(d="12:30:00",u=!0))}if(a==="lazy_stage.end_time"){const f=s(d);(f<s("11:15:00")||f>s("12:45:00"))&&(u=!1,alert("Lazy stage must end between 11:15 AM and 12:45 PM"),f<s("11:15:00")?(d="11:15:00",u=!0):f>s("12:45:00")&&(d="12:45:00",u=!0))}if(a==="aggressive_stage.end_time"&&s(d)>s("12:57:00")&&(u=!1,alert("Aggressive stage cannot end after 12:57 PM"),d="12:57:00",u=!0),!u)return;g.value=!0;const[r,i]=a.split("."),b=r.replace("_stage","");o("update:time",{stageName:b,field:i,value:d}),setTimeout(()=>{switch(a){case"lazy_stage.end_time":o("update:time",{stageName:"aggressive",field:"start_time",value:v(d)});break;case"aggressive_stage.end_time":o("update:time",{stageName:"sniping",field:"start_time",value:v(d)});break}},0)},V=()=>{o("save:time"),console.log("Should emit")};return(d,a)=>(m(),_("div",null,[n(e(J),null,{default:l(()=>[n(e(Q),null,{default:l(()=>[n(e(P),{class:"mx-4 cursor-pointer bg-green-500 text-white",disabled:!g.value,onClick:V},{default:l(()=>a[10]||(a[10]=[p(" Save ")])),_:1},8,["disabled"])]),_:1}),n(e(W),null,{default:l(()=>[n(e(U),null,{default:l(()=>[n(e(T),null,{default:l(()=>a[11]||(a[11]=[p("Lazy Stage")])),_:1}),n(e(T),null,{default:l(()=>a[12]||(a[12]=[p("Aggressive Stage")])),_:1}),n(e(T),null,{default:l(()=>a[13]||(a[13]=[p("Sniping Stage")])),_:1})]),_:1})]),_:1}),n(e(X),null,{default:l(()=>[n(e(U),null,{default:l(()=>[n(e(C),null,{default:l(()=>[c("div",we,[c("div",ke,[c("input",{disabled:!t.isAuctionConfigurable,class:S([t.isAuctionConfigurable?"":"bg-yellow-900","w-35 rounded-md border border-gray-300 px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"]),type:"time",value:t.stages.lazy_stage.start_time,onInput:a[0]||(a[0]=s=>w(s.target.value,"lazy_stage.start_time")),onFocus:a[1]||(a[1]=s=>s.target.showPicker())},null,42,$e)]),c("div",Ve,[c("input",{disabled:"",type:"time",value:t.stages.lazy_stage.end_time,onInput:a[2]||(a[2]=s=>w(s.target.value,"lazy_stage.end_time")),onFocus:a[3]||(a[3]=s=>s.target.showPicker()),class:"w-35 rounded-md border border-gray-300 bg-yellow-900 px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,40,Se)])])]),_:1}),n(e(C),null,{default:l(()=>[c("div",Ae,[c("div",Ie,[c("input",{type:"time",value:t.stages.aggressive_stage.start_time,onInput:a[4]||(a[4]=s=>w(s.target.value,"aggressive_stage.start_time")),onFocus:a[5]||(a[5]=s=>s.target.showPicker()),disabled:"",class:"w-35 rounded-md border border-gray-300 bg-yellow-900 px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,40,Te)]),c("div",Ce,[c("input",{type:"time",value:t.stages.aggressive_stage.end_time,disabled:"",class:"w-35 rounded-md border border-gray-300 bg-yellow-900 px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,8,ze)])])]),_:1}),n(e(C),null,{default:l(()=>[c("div",Be,[c("div",Me,[c("input",{type:"time",value:t.stages.sniping_stage.start_time,onInput:a[6]||(a[6]=s=>w(s.target.value,"sniping_stage.start_time")),disabled:"",onFocus:a[7]||(a[7]=s=>s.target.showPicker()),class:"w-35 rounded-md border border-gray-300 bg-yellow-900 px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,40,De)]),c("div",Ne,[c("input",{type:"time",value:t.stages.sniping_stage.end_time,onInput:a[8]||(a[8]=s=>w(s.target.value,"sniping_stage.end_time")),onFocus:a[9]||(a[9]=s=>s.target.showPicker()),disabled:"",class:"w-35 rounded-md border border-gray-300 bg-yellow-900 px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,40,qe)])])]),_:1})]),_:1})]),_:1})]),_:1})]))}}),Fe={class:"grid gap-2"},Pe={class:"flex justify-center"},Ue=M({__name:"InitiatizationPopover",props:{phillips_accounts_emails:{type:Array,required:!0,default:()=>[]},auction_id:{type:Number,required:!0,default:()=>1},auction_status:{type:String,required:!0,default:()=>"unconfigured"}},emits:["intialization:started"],setup(t,{emit:y}){const o=t,g=y,v=B([]);O(()=>{v.value=o.phillips_accounts_emails.map(d=>({email:d,email_app_password:"",phillips_account_password:""})),console.log(v.value)});const w=B(),V=async()=>{const d={accounts:v.value,auction_session_id:o.auction_id},a=await F.post("/api/auction/initialize",d);console.log(d),g("initialization:started",a.data),console.log(a.data),w.value=!1};return(d,a)=>(m(),I(e(re),{open:w.value,"onUpdate:open":a[0]||(a[0]=s=>w.value=s)},{default:l(()=>[n(e(le),{"as-child":""},{default:l(()=>[n(e(P),{class:"mx-4 cursor-pointer bg-green-500 text-white",disabled:t.auction_status!="unconfigurable"},{default:l(()=>a[1]||(a[1]=[p(" Initialize Bidding Session ")])),_:1},8,["disabled"])]),_:1}),n(e(ie),{class:"sm:max-w-[925px]"},{default:l(()=>[n(e(ne),null,{default:l(()=>[n(e(_e),null,{default:l(()=>a[2]||(a[2]=[p("Phillips Accounts Email ")])),_:1}),n(e(be),null,{default:l(()=>a[3]||(a[3]=[p(" Enter Passwords for the phillips accounts you want used in this auction session ")])),_:1})]),_:1}),c("div",Fe,[(m(!0),_(j,null,K(v.value,(s,u)=>(m(),_("div",{class:"flex grid grid-cols-11 items-center gap-4",key:u},[n(e(ve),{for:`${u}-${s}`,class:"col-span-3"},{default:l(()=>[p(k(s.email),1)]),_:2},1032,["for"]),n(e(ee),{id:`phillips_account_password_${u}`,type:"text",class:"col-span-4 h-8",modelValue:v.value[u].phillips_account_password,"onUpdate:modelValue":r=>v.value[u].phillips_account_password=r,placeholder:"Account Password"},null,8,["id","modelValue","onUpdate:modelValue"]),n(e(ee),{id:`email_app_password_${u}`,type:"text",class:"col-span-4 h-8",modelValue:v.value[u].email_app_password,"onUpdate:modelValue":r=>v.value[u].email_app_password=r,placeholder:"Email Password"},null,8,["id","modelValue","onUpdate:modelValue"])]))),128))]),n(e(ye),null,{default:l(()=>[c("div",Pe,[n(e(P),{class:"cursor-pointer bg-green-500 text-white",onClick:V},{default:l(()=>a[4]||(a[4]=[p(" Initialize ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),je={class:"flex"},Oe={class:"text-sm"},He=["value","min","max"],Le={class:"text-sm"},Ke=M({__name:"Progress",props:{stage:{type:String,required:!1},startTime:{type:String,required:!0},endTime:{type:String,required:!0},name:{type:String,required:!1}},setup(t){const y=t;let o;const g=r=>{const[i,b="00"]=r==null?void 0:r.split(":");return parseInt(i+b)};var v=B(1100),w=B(1200),V=B(1300);const d=()=>{const r=new Date,i=r.getHours().toString().padStart(2,"0"),b=r.getMinutes().toString().padStart(2,"0"),f=r.getSeconds().toString().padStart(2,"0"),h=`${i}:${b}:${f}`;v.value=g(y.startTime),w.value=g(h),V.value=g(y.endTime)},a=B(""),s=()=>{const r=new Date,[i,b,f]=y.endTime.split(":").map(Number),h=new Date;h.setHours(i,b,f,0);const $=h-r;if($<=0){a.value="00:00:00";return}const A=Math.floor($/1e3),D=Math.floor(A/3600),N=Math.floor(A%3600/60),q=A%60,z=E=>E.toString().padStart(2,"0");a.value=`${z(D)}:${z(N)}:${z(q)}`};let u=null;return O(()=>{o=setInterval(d,3e3),s(),u=setInterval(s,1e3)}),se(()=>{clearInterval(o),clearInterval(u)}),(r,i)=>(m(),_("div",je,[c("span",Oe,k(y.startTime),1),c("input",{type:"range",value:e(w),min:e(v),max:e(V),disabled:"",class:"w-150 accent-green-500"},null,8,He),c("span",Le,k(y.endTime),1),i[0]||(i[0]=c("br",null,null,-1)),c("div",{class:S(["fixed top-25 right-25 z-50 rounded p-1 text-center font-mono text-2xl",y.stage=="lazy"?"bg-green-500":y.stage=="aggressive"?"bg-amber-500":y.stage=="sniping"?"bg-red-500":"hidden"])},k(a.value),3)]))}});var H={exports:{}},Re=H.exports,te;function Ye(){return te||(te=1,function(t,y){(function(o,g){t.exports=g()})(Re,function(){return function(o,g,v){o=o||{};var w=g.prototype,V={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function d(s,u,r,i){return w.fromToBase(s,u,r,i)}v.en.relativeTime=V,w.fromToBase=function(s,u,r,i,b){for(var f,h,$,A=r.$locale().relativeTime||V,D=o.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],N=D.length,q=0;q<N;q+=1){var z=D[q];z.d&&(f=i?v(s).diff(r,z.d,!0):r.diff(s,z.d,!0));var E=(o.rounding||Math.round)(Math.abs(f));if($=f>0,E<=z.r||!z.r){E<=1&&q>0&&(z=D[q-1]);var R=A[z.l];b&&(E=b(""+E)),h=typeof R=="string"?R.replace("%d",E):R(E,u,z.l,$);break}}if(u)return h;var Y=$?A.future:A.past;return typeof Y=="function"?Y(h):Y.replace("%s",h)},w.to=function(s,u){return d(s,u,this,!0)},w.from=function(s,u){return d(s,u,this)};var a=function(s){return s.$u?v.utc():v()};w.toNow=function(s){return this.to(a(this),s)},w.fromNow=function(s){return this.from(a(this),s)}}})}(H)),H.exports}var Ze=Ye();const oe=he(Ze),Ge={class:"border-sidebar-border/70 dark:border-sidebar-border mt-4 flex-1 rounded-xl border"},ue=M({__name:"BidsTable",props:{vehicleId:{type:String,required:!1}},setup(t){const{formatKES:y}=ae();L.extend(oe);let o;const g=u=>{const r=L(u);return r.isValid()?r.format("HH:mm:ss"):"Invalid date"},v=t;let w=B([]),V=B(!1);const d=async()=>{try{const f=window.location.pathname.split("/")[2].replaceAll("-"," ").split(" ");f[2]=`${f[2]},`;const h=f.join(" "),$=await F.get(`/api/bid/get_all_for_auction/${h}`);w.value={...$.data,bids:$.data.vehicles||[]},V=!0}catch(u){console.log(u)}},a=async()=>{try{const u={vehicle_id:v.vehicleId},r=await F.post("/api/vehicle/bids",u);console.log(r.data),w.value={...r.data,bids:r.data.vehicles||[]},V=!0}catch(u){console.log(u)}};O(()=>{setTimeout(()=>{v.vehicleId?(a(),o=setInterval(a,3e3)):(d(),o=setInterval(d,3e3))},0)}),se(()=>clearInterval(o));const s=u=>u?`${u[0].toUpperCase()}${u.slice(1)}`:"";return(u,r)=>(m(),_("div",Ge,[n(e(J),null,{default:l(()=>[n(e(Q),null,{default:l(()=>r[0]||(r[0]=[p("Bid History on this Vehicle")])),_:1}),n(e(W),{class:"relative top-0 right-0 left-0 h-20"},{default:l(()=>[n(e(U),null,{default:l(()=>[n(e(T),null,{default:l(()=>r[1]||(r[1]=[p("Name/ID")])),_:1}),n(e(T),null,{default:l(()=>r[2]||(r[2]=[p("Time")])),_:1}),n(e(T),null,{default:l(()=>r[3]||(r[3]=[p("Account")])),_:1}),n(e(T),null,{default:l(()=>r[4]||(r[4]=[p("Stage")])),_:1}),n(e(T),null,{default:l(()=>r[5]||(r[5]=[p("Status")])),_:1}),n(e(T),null,{default:l(()=>r[6]||(r[6]=[p("Amount")])),_:1})]),_:1})]),_:1}),e(w)?(m(),I(e(X),{key:0},{default:l(()=>[(m(!0),_(j,null,K(e(w),(i,b)=>(m(),I(e(U),{class:S(i.status=="highest"||i.status=="Highest"?"text-green-500":i.status=="Toppled"||i.status=="toppled"||i.status=="Outbudgeted"||i.status=="outbudgeted"?"text-red-500":"text-amber-500"),key:b},{default:l(()=>[i.status?(m(),I(e(C),{key:0,class:S(["border-l-4 border-green-500",i.status=="highest"||i.status=="Highest"?"border-green-500":["Toppled","toppled","Outbudgeted","outbudgeted","Outbudged"].includes(i.status)?"border-red-500":"border-amber-500"])},{default:l(()=>{var f;return[p(k((f=i==null?void 0:i.vehicle)==null?void 0:f.phillips_vehicle_id),1)]}),_:2},1032,["class"])):x("",!0),i.status?(m(),I(e(C),{key:1},{default:l(()=>[p(k(g(i.created_at)),1)]),_:2},1024)):x("",!0),i.status?(m(),I(e(C),{key:2},{default:l(()=>{var f;return[p(k((f=i==null?void 0:i.phillips_account)==null?void 0:f.email),1)]}),_:2},1024)):x("",!0),i.status?(m(),I(e(C),{key:3},{default:l(()=>{var f;return[p(k(s((f=i==null?void 0:i.bid_stage)==null?void 0:f.name)),1)]}),_:2},1024)):x("",!0),i.status?(m(),I(e(C),{key:4},{default:l(()=>[p(k(s(i.status)),1)]),_:2},1024)):x("",!0),i.status?(m(),I(e(C),{key:5},{default:l(()=>[p(k(e(y)(i.amount)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["class"]))),128))]),_:1})):x("",!0)]),_:1})]))}}),Je=M({__name:"BidsPopover",props:{vehicleId:{type:String,required:!0}},setup(t){const y=t;return(o,g)=>{const v=de("DialogTitle");return m(),I(e(re),null,{default:l(()=>[n(e(le),{"as-child":""},{default:l(()=>[n(e(P),{class:"cursor-pointer bg-green-500 text-white"},{default:l(()=>g[0]||(g[0]=[p(" View ")])),_:1})]),_:1}),n(e(ie),{class:"sm:max-w-[925px] max-h-[700px] overflow-y-scroll scrollbar-hide"},{default:l(()=>[n(e(ne),null,{default:l(()=>[n(v,{class:"text-center"},{default:l(()=>[p(k(`BIDS FOR ${y.vehicleId}`),1)]),_:1}),n(ue,{vehicleId:y.vehicleId},null,8,["vehicleId"])]),_:1})]),_:1})]),_:1})}}}),Qe={key:0,class:"absolute top-0 right-0 translate-x-1/2 -translate-y-1/2 transform"},We={class:"relative"},Xe={class:"mb-2 w-30 text-center"},et=["value"],tt={class:"relative"},st={class:"mb-2 w-30 text-center"},at=["value"],lt={class:"flex"},it={key:0},nt={class:"flex flex-col space-y-2"},rt={class:"relative"},ot={class:"mb-2 w-30 text-center"},ut=["value"],dt={class:"flex flex-col space-y-2"},ct={class:"relative"},mt={class:"mb-2 w-30 text-center"},gt=["value"],ft={class:"flex flex-col space-y-2"},pt={class:"relative"},vt={class:"mb-2 w-30 text-center"},_t=["value"],bt={key:0},yt={key:1,class:"flex"},ht={key:1},xt={key:2},wt={key:4},kt={key:5},$t=M({__name:"VehicleRow",props:{modelValue:{type:Object,required:!0,default:()=>({id:"Example Vehicle",start_amount:"35000",maximum_amount:"250000",current_bid:"125600",last_bid_time:"2025-05-31 16:18:48",status:"Unconfigured",lazy_stage:{start_time:"10:00:00",end_time:"12:00:00",increment:"3000",status:"active"},aggressive_stage:{start_time:"12:00:01",end_time:"12:55:00",increment:"5000",stage:"dormant"},sniping_stage:{start_time:"12:55:01",end_time:"13:00:00",increment:"10000",stage:"dormant"}})},index:{type:Number,required:!0,default:()=>0},isAuctionConfigurable:{type:Boolean,required:!0,default:()=>!1}},emits:["update:modelValue","update:vehicle-in-db","vehicle-saved"],setup(t,{emit:y}){const{formatKES:o}=ae(),g=t;L.extend(oe);const v=ce(()=>{const i=L(g.modelValue.last_bid_time);return i.isValid()?i.fromNow():"Invalid date"}),w=async i=>{confirm(`Are you sure you want to drop ${i} off the auction? You can bring it back later.`)&&(await F.post("/api/vehicle/drop",{id:i}),V("vehicle-saved"))},V=y,d=B(!1),a=(i,b)=>{d.value=!0;const f={...g.modelValue},h=g.index;f[b]=String(i),V("update:modelValue",f,h)},s=i=>{["Backspace","Delete","Tab","Escape","Enter","."].includes(i.key)||i.key==="a"&&i.ctrlKey||i.key==="c"&&i.ctrlKey||i.key==="v"&&i.ctrlKey||i.key==="x"&&i.ctrlKey||isNaN(Number(i.key))&&i.preventDefault()};me("parent");let u=B(!1);const r=async()=>{try{console.log(g.modelValue.start_amount),console.log(g.modelValue.maximum_amount),u=!0;const i=await F.put("/api/vehicle/update",g.modelValue);d.value=!1,V("vehicle-saved"),console.log("Save successful"),u=!1}catch(i){console.error("Save failed",i)}};return(i,b)=>(m(),I(e(U),null,{default:l(()=>[n(e(C),{class:S(["group relative w-30 cursor-pointer border-l-4 font-medium",t.modelValue.status=="highest"||t.modelValue.status=="active"?"border-green-500":t.modelValue.status=="outbidded"?"border-amber-500":"border-red-500"])},{default:l(()=>[t.modelValue.status==="Highest"?(m(),_("div",Qe,b[6]||(b[6]=[c("div",{class:"relative"},[c("div",{class:"z-10 flex h-4 w-4 items-center justify-center rounded-full bg-green-500"},[c("span",{class:"text-[10px] font-bold text-white"},"!")]),c("div",{class:"absolute inset-0 animate-ping rounded-full bg-green-500 opacity-75"})],-1)]))):x("",!0),p(" "+k(t.modelValue.id),1)]),_:1},8,["class"]),n(e(C),null,{default:l(()=>[c("div",We,[c("div",Xe,k(e(o)(t.modelValue.start_amount)),1),t.isAuctionConfigurable?(m(),_("input",{key:0,type:"number",onKeydown:s,value:t.modelValue.start_amount,onInput:b[0]||(b[0]=f=>a(f.target.value,"start_amount")),placeholder:"4,000",class:"w-30 rounded-md border border-gray-300 px-2 py-1 pl-7 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,40,et)):x("",!0)])]),_:1}),n(e(C),null,{default:l(()=>[c("div",tt,[c("div",st,k(e(o)(t.modelValue.maximum_amount)),1),t.isAuctionConfigurable?(m(),_("input",{key:0,type:"number",onKeydown:s,value:t.modelValue.maximum_amount,onInput:b[1]||(b[1]=f=>a(f.target.value,"maximum_amount")),placeholder:"4,000",class:"w-35 rounded-md border border-gray-300 px-2 py-1 pl-7 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,40,at)):x("",!0)])]),_:1}),t.isAuctionConfigurable?x("",!0):(m(),I(e(C),{key:0},{default:l(()=>[p(k(t.modelValue.bids.length),1)]),_:1})),n(e(C),{class:"cursor-pointer"},{default:l(()=>[c("div",lt,[c("p",{class:S(t.modelValue.current_bid_status=="Highest"||t.modelValue.current_bid_status=="highest"?"text-green-500":t.modelValue.current_bid_status=="Outbidded"||t.modelValue.current_bid_status=="outbidded"?"text-amber-500":"text-red-500")},k(t.modelValue.current_bid<1||t.modelValue.bids.length<1?"None ":e(o)(t.modelValue.current_bid)),3),t.modelValue.current_bid_status?(m(),_("p",{key:0,class:S(["ml-1",t.modelValue.current_bid_status=="Highest"||t.modelValue.current_bid_status=="highest"?"text-green-500":t.modelValue.current_bid_status=="Outbidded"||t.modelValue.current_bid_status=="outbidded"?"text-amber-500":"text-red-500"])},k(`(${t.modelValue.current_bid_status})`),3)):x("",!0)]),t.isAuctionConfigurable?(m(),_("div",it,[c("div",{class:S(["mt-4 flex",t.modelValue.current_bid_status=="Highest"||t.modelValue.current_bid_status=="highest"?"text-green-500":t.modelValue.current_bid_status=="Outbidded"||t.modelValue.current_bid_status=="outbidded"?"text-amber-500":"text-red-500"])},[b[7]||(b[7]=c("div",{class:"mr-2"},[c("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[c("circle",{cx:"12",cy:"12",r:"9"}),c("path",{d:"M12 7v5l3 3"})])],-1)),p(" "+k(v.value),1)],2)])):x("",!0)]),_:1}),n(e(C),{class:S(t.modelValue.status=="highest"||t.modelValue.status=="active"?"text-green-500":t.modelValue.status=="Outbidded"?"text-amber-500":"text-red-500")},{default:l(()=>[p(k(t.modelValue.status),1)]),_:1},8,["class"]),n(e(C),null,{default:l(()=>[c("div",nt,[c("div",rt,[c("div",ot,k(e(o)(t.modelValue.lazy_stage_increment)),1),t.isAuctionConfigurable?(m(),_("input",{key:0,class:S([t.isAuctionConfigurable?"":"bg-yellow-900","w-35 rounded-md border border-gray-300 px-2 py-1 pl-10 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"]),type:"number",onKeydown:s,value:t.modelValue.lazy_stage_increment,onInput:b[2]||(b[2]=f=>a(f.target.value,"lazy_stage_increment")),placeholder:"4,000"},null,42,ut)):x("",!0)])])]),_:1}),n(e(C),null,{default:l(()=>[c("div",dt,[c("div",ct,[c("div",mt,k(e(o)(t.modelValue.aggressive_stage_increment)),1),t.isAuctionConfigurable?(m(),_("input",{key:0,class:S([t.isAuctionConfigurable?"":"bg-yellow-900","w-35 rounded-md border border-gray-300 px-2 py-1 pl-10 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"]),type:"number",value:t.modelValue.aggressive_stage_increment,onInput:b[3]||(b[3]=f=>a(f.target.value,"aggressive_stage_increment")),placeholder:"4,000"},null,42,gt)):x("",!0)])])]),_:1}),n(e(C),null,{default:l(()=>[c("div",ft,[c("div",pt,[c("div",vt,k(e(o)(t.modelValue.sniping_stage_increment)),1),t.isAuctionConfigurable?(m(),_("input",{key:0,class:S([t.isAuctionConfigurable?"":"bg-yellow-900","w-35 rounded-md border border-gray-300 px-2 py-1 pl-10 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500"]),type:"number",onKeydown:s,value:t.modelValue.sniping_stage_increment,onInput:b[4]||(b[4]=f=>a(f.target.value,"sniping_stage_increment")),placeholder:"4,000"},null,42,_t)):x("",!0)])])]),_:1}),n(e(C),null,{default:l(()=>[t.isAuctionConfigurable?(m(),I(e(P),{key:0,class:S(["cursor-pointer",d.value&&t.modelValue.status!="active"?"bg-green-500":""]),onClick:r},{default:l(()=>[e(u)?(m(),_("div",yt,b[8]||(b[8]=[c("svg",{class:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[c("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),c("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),c("span",null,"Saving",-1)]))):(m(),_("div",bt,"Save"))]),_:1},8,["class"])):x("",!0),t.isAuctionConfigurable?(m(),_("br",ht)):x("",!0),t.isAuctionConfigurable?(m(),_("br",xt)):x("",!0),t.isAuctionConfigurable?(m(),I(e(P),{key:3,class:"cursor-pointer bg-red-500 text-white",onClick:b[5]||(b[5]=f=>w(t.modelValue.id))},{default:l(()=>b[9]||(b[9]=[p(" Drop Off ")])),_:1})):x("",!0),t.isAuctionConfigurable?(m(),_("br",wt)):x("",!0),t.isAuctionConfigurable?(m(),_("br",kt)):x("",!0),n(Je,{vehicleName:t.modelValue.name,vehicleId:t.modelValue.id},null,8,["vehicleName","vehicleId"])]),_:1})]),_:1}))}}),Vt=M({__name:"VehiclesTable",props:{vehicles:{type:Object,required:!0,default:()=>[]},isAuctionConfigurable:{type:Boolean,required:!0,default:()=>!1},activeStage:{type:Object,required:!0,default:()=>({name:"none"})}},emits:["update-vehicle","update-vehicle-in-DB","vehicle-saved"],setup(t,{emit:y}){const o=y,g=(V,d)=>{o("update-vehicle",V,d)},v=()=>{o("update-vehicle-in-DB")},w=()=>{o("vehicle-saved")};return(V,d)=>(m(),_("div",null,[n(e(J),null,{default:l(()=>[n(e(Q),null,{default:l(()=>d[0]||(d[0]=[p("A list of vehicles in the auction.")])),_:1}),n(e(W),null,{default:l(()=>[n(e(U),null,{default:l(()=>{var a,s,u;return[n(e(T),null,{default:l(()=>d[1]||(d[1]=[p("Name")])),_:1}),n(e(T),null,{default:l(()=>d[2]||(d[2]=[p("Start Amount")])),_:1}),n(e(T),null,{default:l(()=>d[3]||(d[3]=[p("Maximum Amount")])),_:1}),t.isAuctionConfigurable?x("",!0):(m(),I(e(T),{key:0},{default:l(()=>d[4]||(d[4]=[p("Total Bids")])),_:1})),n(e(T),null,{default:l(()=>[p(k(t.isAuctionConfigurable?"Current Bid":"Final Bid"),1)]),_:1}),n(e(T),null,{default:l(()=>d[5]||(d[5]=[p("Status")])),_:1}),n(e(T),{class:S(((a=t.activeStage)==null?void 0:a.name)=="lazy"?"bg-green-500 text-black":"")},{default:l(()=>d[6]||(d[6]=[p("Lazy Stage Increment")])),_:1},8,["class"]),n(e(T),{class:S(((s=t.activeStage)==null?void 0:s.name)=="aggressive"?"bg-amber-500 text-black":"")},{default:l(()=>d[7]||(d[7]=[p("Aggressive Stage Increment")])),_:1},8,["class"]),n(e(T),{class:S(((u=t.activeStage)==null?void 0:u.name)=="sniping"?"bg-red-500 text-black":"")},{default:l(()=>d[8]||(d[8]=[p("Sniping Stage Increment")])),_:1},8,["class"]),n(e(T),null,{default:l(()=>d[9]||(d[9]=[p("Actions")])),_:1})]}),_:1})]),_:1}),n(e(X),{class:"max-h-[80vh] min-h-[80vh] overflow-y-auto"},{default:l(()=>[(m(!0),_(j,null,K(V.$props.vehicles,(a,s)=>(m(),I($t,{key:s,modelValue:a,index:s,"onUpdate:modelValue":g,"onUpdate:vehicleInDb":v,onVehicleSaved:w,isAuctionConfigurable:t.isAuctionConfigurable},null,8,["modelValue","index","isAuctionConfigurable"]))),128))]),_:1})]),_:1})]))}}),St={class:"border-sidebar-border/70 dark:border-sidebar-border flex-1 rounded-xl border"},At={class:"text-3rem p-4 text-2xl font-bold tracking-tight sm:text-3xl"},It={class:"text2rem p-4 text-xl tracking-tight"},Tt={class:"flex w-full justify-center p-4"},Ct={key:0,class:"flex w-full justify-center p-4"},zt={key:1,class:"flex w-full justify-center p-4"},Bt={class:"relative"},Mt=M({__name:"AuctionConfigurationSection",emits:["initialization:started"],setup(t,{expose:y,emit:o}){const g=B({start_time:"11:00:00",end_time:"13:00:00",vehicles:[]}),v=B([]),w=h=>({lazy_stage:h.find($=>$.name==="lazy"),aggressive_stage:h.find($=>$.name==="aggressive"),sniping_stage:h.find($=>$.name==="sniping")}),V=o,d=h=>{V("initialization:started",h)};let a=B(!1);const s=async()=>{try{const N=window.location.pathname.split("/")[2].replaceAll("-"," ").split(" ");N[2]=`${N[2]},`;const q=N.join(" "),z=await F.get(`/api/auction/${q}`);g.value={...z.data,vehicles:z.data.vehicles||[]},v.value=g.value.bid_stages,console.log(g),a=!0}catch(h){console.log(h)}},u=({stageName:h,field:$,value:A})=>{const D=v.value.findIndex(N=>N.name===h);D!==-1&&(v.value[D][$]=A,w(v.value))};O(()=>{[".bid.created",".account.testresults"].forEach($=>{window.Echo.channel("public-channel").listen($,A=>{s()})}),setTimeout(()=>{s()},0)});const r=(h,$)=>{g.value.vehicles[$]=h},i=async()=>{try{const h=await F.put(`/api/auction/${g.value.id}/vehicles`,{vehicles:g.value.vehicles});console.log("Save successful",h.data)}catch(h){console.error("Save failed",h)}},b=async()=>{await F.post("/api/auction/bid_stages/update",v.value),await s(),await console.log(v.value)};y({saveAllVehicles:i});function f(h){const $=new Date(h+"T00:00:00Z"),A=new Date,D=Date.UTC(A.getFullYear(),A.getMonth(),A.getDate());return $.getTime()==D}return(h,$)=>{var A;return m(),_("div",St,[c("h2",At,k(g.value.title),1),c("h3",It,k(g.value.status),1),c("div",Tt,[f(g.value.date)?(m(),I(Ke,{key:0,disabled:"",stage:(A=g.value.bid_stage)==null?void 0:A.name,name:"Progress",startTime:g.value.start_time,endTime:g.value.end_time},null,8,["stage","startTime","endTime"])):x("",!0)]),f(g.value.date)?(m(),_("div",Ct,[n(Ue,{phillips_accounts_emails:g.value.phillips_accounts_emails,auction_id:g.value.id,auction_status:g.value.status,"onInitialization:started":d},null,8,["phillips_accounts_emails","auction_id","auction_status"])])):x("",!0),f(g.value.date)?(m(),_("div",zt,[e(a)?(m(),I(Ee,{key:0,stages:w(v.value),isAuctionConfigurable:g.value.status=="unconfigured","onUpdate:time":u,"onSave:time":b,onVehicleSaved:s},null,8,["stages","isAuctionConfigurable"])):x("",!0)])):x("",!0),c("div",Bt,[n(Vt,{activeStage:g.value.bid_stage,vehicles:g.value.vehicles,onUpdateVehicle:r,onUpdateVehicleInDB:s,isAuctionConfigurable:f(g.value.date)&&(g.value.status=="configured"||g.value.status=="active")},null,8,["activeStage","vehicles","isAuctionConfigurable"])])])}}}),Dt=M({__name:"Alert",props:{class:{},variant:{}},setup(t){const y=t;return(o,g)=>(m(),_("div",{"data-slot":"alert",class:S(e(G)(e(Et)({variant:o.variant}),y.class)),role:"alert"},[Z(o.$slots,"default")],2))}}),Nt=M({__name:"AlertDescription",props:{class:{}},setup(t){const y=t;return(o,g)=>(m(),_("div",{"data-slot":"alert-description",class:S(e(G)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",y.class))},[Z(o.$slots,"default")],2))}}),qt=M({__name:"AlertTitle",props:{class:{}},setup(t){const y=t;return(o,g)=>(m(),_("div",{"data-slot":"alert-title",class:S(e(G)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",y.class))},[Z(o.$slots,"default")],2))}}),Et=pe("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}}),Ft={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Pt={key:0,cx:"12",cy:"12",r:"11",stroke:"#10B981","stroke-width":"2",fill:"none"},Ut={key:1,d:"M16 8L8 16",stroke:"#10B981","stroke-width":"2","stroke-linecap":"round"},jt={key:2,d:"M8 8L16 16",stroke:"#10B981","stroke-width":"2","stroke-linecap":"round"},Ot={key:3,cx:"12",cy:"12",r:"11",stroke:"#EF4444","stroke-width":"2",fill:"none"},Ht={key:4,d:"M16 8L8 16",stroke:"#EF4444","stroke-width":"2","stroke-linecap":"round"},Lt={key:5,d:"M8 8L16 16",stroke:"#EF4444","stroke-width":"2","stroke-linecap":"round"},Kt={key:6,cx:"12",cy:"12",r:"11",stroke:"#F59E0B","stroke-width":"2",fill:"none"},Rt={key:7,d:"M16 8L8 16",stroke:"#F59E0B","stroke-width":"2","stroke-linecap":"round"},Yt={key:8,d:"M8 8L16 16",stroke:"#F59E0B","stroke-width":"2","stroke-linecap":"round"},Zt=M({__name:"Alert",props:{id:{type:Number,required:!0},type:{type:String,required:!0,default:()=>"success"},title:{type:String,required:!0},description:{type:String,required:!0},time:{type:String,requied:!0}},emits:["dismiss"],setup(t,{emit:y}){const o=t,g=y,v=()=>{g("dismiss",o.id)};return(w,V)=>(m(),I(e(Dt),{class:S(["w-150 border p-4",o.type=="success"?"border-green-500 text-green-500":o.type=="fail"?"border-red-500 text-red-500":o.type=="amber"?"border-amber-500 text-amber-500":"border-blue-500 text-blue-500"])},{default:l(()=>[c("div",{class:"absolute top-1 right-1 cursor-pointer",onClick:v},[(m(),_("svg",Ft,[o.type=="success"?(m(),_("circle",Pt)):x("",!0),o.type=="success"?(m(),_("path",Ut)):x("",!0),o.type=="success"?(m(),_("path",jt)):x("",!0),o.type=="fail"?(m(),_("circle",Ot)):x("",!0),o.type=="fail"?(m(),_("path",Ht)):x("",!0),o.type=="fail"?(m(),_("path",Lt)):x("",!0),o.type=="amber"?(m(),_("circle",Kt)):x("",!0),o.type=="amber"?(m(),_("path",Rt)):x("",!0),o.type=="amber"?(m(),_("path",Yt)):x("",!0)]))]),n(e(qt),null,{default:l(()=>[p(k(o.title),1)]),_:1}),n(e(Nt),null,{default:l(()=>[c("p",null,[c("span",{class:S(o.type=="success"?"text-green-500":o.type=="fail"?"text-red-500":o.type=="amber"?"text-amber-500":"text-blue-500")}," ["+k(o.time)+"] ",3),p(" "+k(" "+o.description),1)])]),_:1})]),_:1},8,["class"]))}}),Gt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Jt={class:"pointer-events-none fixed inset-0 z-50"},Qt={class:"fixed right-4 bottom-4 flex flex-col items-end space-y-2"},rs=M({__name:"Auction",setup(t){const y=[{title:"Auction",href:"/auction"}],o=B([]),g=()=>{const s=new Audio("/sounds/success_beep.mp3");s.currentTime=0,s.play()},v=()=>{const s=new Audio("/sounds/failure_beep.mp3");s.currentTime=0,s.play()},w=()=>{const s=new Audio("/sounds/notification_beep.mp3");s.currentTime=0,s.play()};let V;const d=s=>{o.value=o.value.filter(u=>u.id!==s)};O(()=>{[".bid.created",".account.testresults"].forEach(u=>{window.Echo.channel("public-channel").listen(u,r=>{r.type=="success"?g():r.type=="fail"?v():w();const i={id:r.id,type:r.type,title:r.title,description:r.description,time:r.time};o.value.unshift(i),setTimeout(()=>{d(i.id)},9e4)})})}),ge(()=>{clearInterval(V)});const a=s=>{o.value.unshift(s),setTimeout(()=>{d(s.id)},9e4)};return(s,u)=>(m(),_(j,null,[n(e(fe),{title:"Auction"}),n(xe,{breadcrumbs:y},{default:l(()=>[c("div",Gt,[c("div",null,[c("div",Jt,[c("div",Qt,[(m(!0),_(j,null,K(o.value,r=>(m(),I(Zt,{key:r.id,type:r.type,title:r.title,description:r.description,time:r.time,id:r.id,onDismiss:i=>d(r.id),class:"pointer-events-auto"},null,8,["type","title","description","time","id","onDismiss"]))),128))])]),n(Mt,{"onInitialization:started":a}),n(ue)])])]),_:1})],64))}});export{rs as default};
